# name: Run Full Test Suite

# on:
#   push:
#     branches: [ main ]
#   pull_request:
#     branches: [ main ]

# jobs:
#   test:
#     runs-on: ubuntu-latest

#     steps:
#     - name: 📥 Checkout code
#       uses: actions/checkout@v3

#     - name: ♻️ Cache pip
#       uses: actions/cache@v3
#       with:
#         path: ~/.cache/pip
#         key: ${{ runner.os }}-pip-${{ hashFiles('**/requirements.txt') }}
#         restore-keys: |
#           ${{ runner.os }}-pip-

#     - name: 🐍 Set up Python
#       uses: actions/setup-python@v4
#       with:
#         python-version: '3.10'

#     - name: 📦 Install dependencies
#       run: |
#         python -m pip install --upgrade pip
#         pip install -r requirements.txt
#         pip install pytest-asyncio

#     - name: 🔧 Make test script executable
#       run: chmod +x tests/run_all_tests.sh

#     - name: 🧪 Run all tests
#       run: ./tests/run_all_tests.sh
#       env:
#         OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}

#     - name: 📁 Upload test logs
#       if: always()
#       uses: actions/upload-artifact@v4
#       with:
#         name: test-logs-${{ github.run_id }}
#         path: tests/logs/test_check_logs
#         if-no-files-found: ignore

#     - name: 📤 Notify on Success with Button
#       if: success()
#       run: |
#         curl -s -X POST https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN_TEST_NOTIFIER }}/sendMessage \
#         -d chat_id=${{ secrets.TELEGRAM_CHAT_ID }} \
#         -d text="🟢 Թեստերը հաջողությամբ անցան ✅\n🔗 Տես logs-ը GitHub Actions-ում՝" \
#         -d parse_mode="HTML" \
#         -d reply_markup='{
#               "inline_keyboard": [[
#                   {
#                       "text": "📄 Բացել Logs-ը",
#                       "url": "https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}"
#                   }
#               ]]
#             }'

#     - name: ❌ Notify on Failure with Button
#       if: failure()
#       run: |
#         curl -s -X POST https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN_TEST_NOTIFIER }}/sendMessage \
#         -d chat_id=${{ secrets.TELEGRAM_CHAT_ID }} \
#         -d text="🚨 Թեստերից որոշները FAILED են ❌\n🔎 Տես logs-ը GitHub Actions-ում՝" \
#         -d parse_mode="HTML" \
#         -d reply_markup='{
#               "inline_keyboard": [[
#                   {
#                       "text": "📄 Բացել Logs-ը",
#                       "url": "https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}"
#                   }
#               ]]
#             }'
